var R=Object.create;var f=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty;var h=(r,s)=>{for(var o in s)f(r,o,{get:s[o],enumerable:!0})},P=(r,s,o,e)=>{if(s&&typeof s=="object"||typeof s=="function")for(let t of A(s))!B.call(r,t)&&t!==o&&f(r,t,{get:()=>s[t],enumerable:!(e=b(s,t))||e.enumerable});return r};var v=(r,s,o)=>(o=r!=null?R(S(r)):{},P(s||!r||!r.__esModule?f(o,"default",{value:r,enumerable:!0}):o,r)),w=r=>P(f({},"__esModule",{value:!0}),r);var x={};h(x,{Profissional:()=>m});module.exports=w(x);var y=require("knex"),E={client:"pg",connection:{host:process.env.DATABASE_HOST,port:Number(process.env.DATABASE_PORT),user:process.env.DATABASE_USER,password:process.env.DATABASE_PASSWORD,database:process.env.DATABASE_NAME}},_=(0,y.knex)(E),c=_;var u=class{async getProfissionais(){try{return await c.select("*").from("profissional").where({ativo:1})}catch(s){return{status:500,messageClient:"Erro ao buscar profissionais !",messageServer:s}}}async postProfissional(s){try{return await c("profissional").insert(s),{status:201,messageClient:"Profissional criado com sucesso!"}}catch(o){return{status:500,messageClient:"Erro ao criar profissional !",messageServer:o}}}async putProfissional(s,o){try{return await c("profissional").where({cd_profissional:o}).update(s),{status:200,messageClient:"Profissional atualizado com sucesso!"}}catch(e){return{status:500,messageClient:"Erro ao atualizar profissional !",messageServer:e}}}},n=new u;var i=require("zod"),d=v(require("bcrypt")),g=i.z.object({data:i.z.object({cd_profissional:i.z.number().optional().nullable(),nm_profissional:i.z.string(),email:i.z.string().optional().nullable(),numero_telefone:i.z.string(),senha:i.z.string(),privilegio:i.z.string(),registro:i.z.string(),cd_tipo_profissional:i.z.number().optional().nullable(),ativo:i.z.string().optional().nullable()})}),m=class{async getProfissionais(s,o){try{let e=await n.getProfissionais();return o.status(200).send(e)}catch(e){return console.log(e),o.status(500).send({message:"Internal server error",messageError:e})}}async postProfissional(s,o){console.log(s.body);let{data:e}=g.parse(s.body);d.default.hash(e.senha,10,(t,a)=>{e.senha=a}),e.ativo="1";try{let t=await n.postProfissional(e);if(console.log(t),t.status===201){let a=await n.getProfissionais();return o.status(201).send(a)}if(t.status===500)return o.status(500).send(t)}catch{return}}async putProfissional(s,o){let{cd_profissional:e}=s.query,{data:t}=g.parse(s.body),a=new Object;for(let l in t)t[l]!=null&&(a[l]=t[l]);let p=await n.putProfissional(a,e);if(p.status===200){let l=await n.getProfissionais();return o.status(200).send(l)}if(p.status===500)return o.status(500).send(p)}};0&&(module.exports={Profissional});
